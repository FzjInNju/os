## 静态链接 动态链接

## 动态链接

1. 动态链接器自举：

   动态链接器要重定位共享对象，但他自身也是共享对象，因此，动态链接器要完成对自身的重定位，因此， **一是动态连接器本身不可以依赖于任何共享对象、二是动态链接器本身所需要的全局和静态变量和重定位由他自身做**，第二个特殊的启动过程被称为自举。

   动态链接器入口地址就是自举代码的入口，当操作系统将进程控制权交给动态链接器时，动态链接器的自举代码开始运行。	自举代码首先找GOT（全局偏移表，存绝对地址）中的第一个段“.dynamic”段，由此找到动态链接器本身的重定位表和符号表，从而动态链接器完成本身的重定位，可以使用自身的全局变量和静态变量。

2. 装载对象

   - 完成自举之后，动态链接器将可执行文件和链接器本身的符号表合并到一个符号表中，我们将其称为“全局符号表GST“
   - 链接器寻找可执行文件所依赖的共享对象：在.dynamic段中的DT_NEEDED类型中包含可执行文件所依赖的共享对象，动态链接器将这些共享对象的名字放入到一个装载集合中，并将共享对象的符号表合并到全局符号表中
   - 链接器从装载集合中取所需要的共享对象的名字，找到相应的文件后打开该文件，重复以上过程，直到所有的共享对象都被放入装载集合、全局符号表中包含进程中所有动态链接所需要的符号。

3. 重定位和初始化

   

### linux下可执行文件的默认地址是从0x08048000开始分配的

之前用来存堆栈，因为堆栈需要一定的空间且不允许栈溢出（栈溢出时要检测到，同时使进程崩溃，否则栈溢出有可能覆盖其他有用代码），所以，将栈的起始地址设置在可执行文件前，为栈预留大约128MB空间（历史原因，而0x08048000大约就是128mb），当栈向低地址延伸时，最大可延伸到 0 地址处，此时触发空指针解引用，进程崩溃。